---
import Layout from '~/layouts/PageLayout.astro';
import HeroText from '~/components/widgets/HeroText.astro';
import { Icon } from 'astro-icon/components';
import { fetchCultById } from '~/utils/page';
import Image from '~/components/common/Image.astro';
import { findImage } from '~/utils/images';
import { getPermalink } from '~/utils/permalinks';

const metadata = {
  title: 'Programa de actos y cultos de San Isidro | Hermandad de San Isidro Labrador',
  ignoreTitleTemplate: true,
};

const schedule = await fetchCultById('san-isidro');
---

<Layout metadata={metadata}>
  <HeroText tagline="San Isidro 2023" title="Programa de cultos y actos" subtitle={undefined} />
  <div class="mx-auto pb-8 w-full max-w-7xl">
    <div class="mx-auto max-w-4xl">
      <div class="mt-5 sm:mt-10 flex flex-col">
        {
          schedule.days.map((day) => (
            <div>
              <span class="bg-green-100 dark:bg-slate-800 not-prose flex items-center py-3 px-5">
                <Icon name="tabler:calendar" class="mr-4 w-6 h-6" />
                <h3 class="text-sm font-semibold uppercase tracking-wide">{day.title}</h3>
              </span>
              <ul class="py-1 flex flex-col">
                {day.event.map((event) => (
                  <li class="group py-3 px-2 sm:px-5 flex items-center">
                    <div class="flex-shrink-0 mr-5 sm:mr-20 px-2 flex flex-col bg-green-50 dark:bg-slate-700">
                      <span class="text-sm sm:text-base text-primary font-bold dark:text-secondary">{event.time}</span>
                    </div>
                    <div class="col-span-7 sm:col-span-6 px-3">
                      <p class="flex items-center">
                        <Icon name="tabler:map-pin" class="mr-1 w-4 h-4" />
                        {event.location}
                      </p>
                      <p class="font-bold uppercase">{event.title}</p>
                      <div class="mt-2" set:html={event.description} />
                      {event.image && (
                        <div class="relative md:h-64 bg-gray-400 dark:bg-slate-700 rounded shadow-lg mb-6">
                          <a href={getPermalink(event.image)}>
                            <Image
                              src={event.image}
                              class="w-full md:h-full rounded shadow-lg bg-gray-400 dark:bg-slate-700 my-4"
                              widths={[400, 900]}
                              width={400}
                              sizes="(max-width: 900px) 400px, 900px"
                              alt={event.title}
                              layout="cover"
                              loading="lazy"
                              decoding="async"
                            />
                          </a>
                        </div>
                      )}
                    </div>
                  </li>
                ))}
              </ul>
            </div>
          ))
        }
      </div>
    </div>
  </div>
</Layout>
